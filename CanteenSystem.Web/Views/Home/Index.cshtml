
@using Microsoft.AspNetCore.Identity
@inject SignInManager<ApplicationUser> SignInManager
@using Microsoft.AspNetCore.Authorization
@using System.Security.Claims;
@inject IAuthorizationService AuthorizationService
@inject UserManager<ApplicationUser> UserManager
 
@using IdentityModel; 
@{
    ViewData["Title"] = "Home Page";
    var userClaimId = User.Claims.FirstOrDefault(c => c.Type == ClaimTypes.UserData);
    var userId = userClaimId == null ? 0 : Convert.ToInt32(userClaimId.Value);
}
<style>
    .home-wrapper p{
        margin-top: 50px;
    }
</style>
<div class="text-center home-wrapper" >
    <h1 class="display-4">Welcome To Meal booking System</h1>
    <!-- Small boxes (Stat box) -->
    @if (SignInManager.IsSignedIn(User))
    {
    <div class="row">

        @if (SignInManager.IsSignedIn(User) && User.Claims.Any(c => c.Type == JwtClaimTypes.Role && c.Value == "Student"))
        {
            <div class="col-lg-6 col-6">
                <!-- small box -->
                <div class="small-box bg-gradient-green" style="margin: 30px 60px">
                    <div class="inner" style="height:200px">
                        <h3>Orders</h3>

                        <p>View your Orders</p>
                    </div>
                    <div class="icon">
                        <i class="ion ion-bag"></i>
                    </div>
                    <a href="/order/student" class="small-box-footer">More info <i class="fas fa-arrow-circle-right"></i></a>
                </div>
            </div>
            <!-- ./col -->

            <div class="col-lg-6 col-6">
                <!-- small box -->
                <div class="small-box bg-gradient-teal" style="margin: 30px 60px">
                    <div class="inner" style="height:200px">
                        <h3> Balance</h3>

                        <p>View your Fund details</p>
                    </div>
                    <div class="icon">
                        <i class="ion ion-stats-bars"></i>
                    </div>
                    <a href="/cards/student/@(userId)" class="small-box-footer">More info <i class="fas fa-arrow-circle-right"></i></a>
                </div>
            </div>

            <!-- ./col -->
            <div class="col-lg-6 col-6">
                <!-- small box -->
                <div class="small-box bg-gradient-warning" style="margin: 30px 60px">
                    <div class="inner" style="height:200px">
                        <h3>Profile</h3>

                        <p>View your Personal Information</p>
                    </div>
                    <div class="icon">
                        <i class="ion ion-person-add"></i>
                    </div>
                    <a href="/ShowUserProfile/@(userId)" class="small-box-footer">More info <i class="fas fa-arrow-circle-right"></i></a>
                </div>
            </div>

            <!-- ./col -->
            <div class="col-lg-6 col-6">
                <!-- small box -->
                <div class="small-box bg-gradient-cyan" style="margin: 30px 60px">
                    <div class="inner" style="height:200px">
                        <h3>Cart</h3>

                        <p>View your Cart</p>
                    </div>
                    <div class="icon">
                        <i class="ion ion-pie-graph"></i>
                    </div>
                    <a href="#" class="small-box-footer">More info <i class="fas fa-arrow-circle-right"></i></a>
                </div>
            </div>
        }
        else if (SignInManager.IsSignedIn(User) && User.Claims.Any(c => c.Type == JwtClaimTypes.Role && c.Value == "Admin"))
        {
            <div class="col-lg-6 col-6">
                <!-- small box -->
                <div class="small-box bg-gradient-green" style="margin: 30px 60px">
                    <div class="inner" style="height:200px">
                        <h3>Orders</h3>

                        <p>View all Available Orders</p>
                    </div>
                    <div class="icon">
                        <i class="ion ion-bag"></i>
                    </div>
                    <a href="/orders" class="small-box-footer">More info <i class="fas fa-arrow-circle-right"></i></a>
                </div>
            </div>
            <!-- ./col -->
            <div class="col-lg-6 col-6">
                <!-- small box -->
                <div class="small-box bg-gradient-warning" style="margin: 30px 60px">
                    <div class="inner" style="height:200px">
                        <h3> Profile</h3>

                        <p>View your Personal Information</p>
                    </div>
                    <div class="icon">
                        <i class="ion ion-person-add"></i>
                    </div>
                    <a href="/ShowUserProfile/@(userId)" class="small-box-footer">More info <i class="fas fa-arrow-circle-right"></i></a>
                </div>
            </div>

        }
        else
        {
            <div class="col-lg-6 col-6">
                <!-- small box -->
                <div class="small-box bg-gradient-warning" style="margin: 30px 60px">
                    <div class="inner" style="height:200px">
                        <h3> Profile</h3>

                        <p>View your Personal Information</p>
                    </div>
                    <div class="icon">
                        <i class="ion ion-person-add"></i>
                    </div>
                    <a href="/ShowUserProfile/@(userId)" class="small-box-footer">More info <i class="fas fa-arrow-circle-right"></i></a>
                </div>
            </div>

            <div class="col-lg-6 col-6">
                <!-- small box -->
                <div class="small-box bg-gradient-teal" style="margin: 30px 60px">
                    <div class="inner" style="height:200px">
                        <h3> Balance</h3>

                        <p>View your child's Account Balance</p>
                    </div>
                    <div class="icon">
                        <i class="ion ion-stats-bars"></i>
                    </div>
                    <a href="/cards/parent/@(userId)" class="small-box-footer">More info <i class="fas fa-arrow-circle-right"></i></a>
                </div>
            </div>
        }
        <!-- ./col -->
    </div>
    <!-- /.row -->
    } 
    else { 
       <a class="btn btn-primary" href="/login">Go to login</a>
    }
</div>
